---
title: "zustand ë¦¬ë Œë”ë§ ìµœì†Œí™”í•˜ê¸°"
date: "2025-12-09"
description: "ê³¼ì œë¥¼ í•˜ë©° ì €ì§ˆë €ë˜ ì‹¤ìˆ˜ë¥¼ ì§€ê¸ˆì´ë¼ë„ ëŒì•„ë³´ëŠ” ê³µë¶€ì‹œê°„"
tag: ["React", "zustand"]
thumbnail: "/images/zustand.png"
---

ì´ì „ì— ê³¼ì œë¥¼ ì§„í–‰í•˜ë©° zustandë¡œ ìƒíƒœ ê´€ë¦¬ë¥¼ í–ˆìŠµë‹ˆë‹¤.
ì´í›„ ê³¼ì œë¥¼ ë¦¬ë·°í•˜ëŠ” ê³¼ì •ì—ì„œ ìƒíƒœë¥¼ ê°€ì ¸ì˜¤ëŠ” ë°©ì‹ì„ ì•„ë¬´ë ‡ê²Œë‚˜ ì‚¬ìš©í•˜ê³  ìˆì—ˆê³ , ì´ê²ƒì´ ë¦¬ë Œë”ë§ ë¬¸ì œë¡œ ë°œìƒí•  ìˆ˜ ìˆë‹¤ëŠ” ê²ƒì„ ê¹¨ë‹¬ì•˜ìŠµë‹ˆë‹¤.

zustandì—ì„œ ìƒíƒœë¥¼ ê°€ì ¸ì˜¬ ë•ŒëŠ” êµ¬ì¡° ë¶„í•´ í• ë‹¹ ë°©ì‹ê³¼ selectorë¥¼ í†µí•´ ì¼ë¶€ ìƒíƒœë§Œ êµ¬ë…í•˜ëŠ” ë°©ì‹ì´ ìˆìŠµë‹ˆë‹¤.
ë‘ ê°€ì§€ ë°©ì‹ ëª¨ë‘ ìƒíƒœë¥¼ ê°€ì ¸ì˜¤ì§€ë§Œ ê°’ì´ ë³€ê²½ë˜ì—ˆì„ ë•Œ ë¦¬ë Œë”ë§ì€ ì„œë¡œ ë‹¤ë¥´ê²Œ ë™ì‘í•©ë‹ˆë‹¤.

ë‹¤ì‹œëŠ” ì´ëŸ° ì‹¤ìˆ˜ë¥¼ í•˜ì§€ ì•Šê¸° ìœ„í•´ ì™œ ì´ë ‡ê²Œ ë™ì‘í•˜ëŠ”ì§€ ì•Œì•„ë³´ë ¤ê³  í•©ë‹ˆë‹¤.

# TL;DR

## êµ¬ì¡° ë¶„í•´ í• ë‹¹ ë°©ì‹

```ts
const { bears, increasePopulation } = useBearStore();
```

ì „ì²´ store ê°ì²´ë¥¼ êµ¬ë…
ì–´ë–¤ ìƒíƒœê°€ ë³€ê²½ë˜ì–´ë„ ìƒˆ ê°ì²´ ì°¸ì¡°ê°’ ìƒì„± -> í•­ìƒ ë¦¬ë Œë”ë§ ë°œìƒ

## Selector ë°©ì‹

```ts
const bears = useBearStore((state) => state.bears);
```

íŠ¹ì • ìƒíƒœë§Œ êµ¬ë…
í•´ë‹¹ ê°’ì´ ì‹¤ì œë¡œ ë³€ê²½ë  ë•Œë§Œ ë¦¬ë Œë”ë§

## ë™ì‘ ì›ë¦¬

ìƒíƒœ ê´€ë¦¬: vanilla.tsì—ì„œ í´ë¡œì €ë¡œ stateë¥¼ ê´€ë¦¬í•˜ê³ , Object.assignìœ¼ë¡œ ë¶ˆë³€ì„± ìœ ì§€
êµ¬ë… ì‹œìŠ¤í…œ: Setìœ¼ë¡œ ë¦¬ìŠ¤ë„ˆ ê´€ë¦¬ (ì¤‘ë³µ ë°©ì§€ + O(1) ì‚­ì œ)
React ì—°ë™: useSyncExternalStoreê°€ Selector ê²°ê³¼ë¥¼ Object.isë¡œ ë¹„êµí•´ ë¦¬ë Œë”ë§ ê²°ì •

# Store ë§Œë“¤ê¸°

zustandì—ì„œ storeë¥¼ ë§Œë“œëŠ” ë°©ì‹ì€ ë§¤ìš° ê°„ë‹¨í•©ë‹ˆë‹¤.

```ts
import { create } from "zustand";

const useBearStore = create((set) => ({
  // ê°’(ìƒíƒœ)
  bears: 0,

  // ì•¡ì…˜(ìƒíƒœ ë³€ê²½)
  increasePopulation: () => set((state) => ({ bears: state.bears + 1 })),
  removeAllBears: () => set({ bears: 0 }),
  updateBears: (newBears) => set({ bears: newBears }),
}));
```

- `create`ë¥¼ í†µí•´ ìŠ¤í† ì–´ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.
  - storeì—ì„œ ê´€ë¦¬í•  ê°’(ìƒíƒœ)ë¥¼ ë§Œë“¤ì–´ ì¤ë‹ˆë‹¤.
  - ìƒíƒœë¥¼ ë³€ê²½í•  ì•¡ì…˜ í•¨ìˆ˜ë¥¼ ì •ì˜í•©ë‹ˆë‹¤.

ì´ë ‡ê²Œ ë§Œë“  storeë¥¼

```ts
import { useBearStore } from './useBearStore';

function Counter() {
  const { bears, increasePopulation, removeAllBears } = useBearStore();

  return (
    <div>
      <p>ê³° {bears} ë§ˆë¦¬</p>
      <button onClick={increasePopulation}>+1</button>
      <button onClick={removeAllBears}>ì´ˆê¸°í™”í•˜ê¸°</button>
    </div>
  )
}
```

ì‚¬ìš©í•˜ëŠ” ì»´í¬ë„ŒíŠ¸ì—ì„œ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

- ì´ë•Œ ë¶ˆëŸ¬ì˜¤ëŠ” ë°©ì‹ì€
  - `const { bears, increasePopulation, removeAllBears } = useBearStore();`
  - `const bears = useBearStore(state=>state.bears);`

  êµ¬ì¡°ë¶„í•´ í• ë‹¹ê³¼ selectorë°©ì‹ìœ¼ë¡œ ê°€ì ¸ì˜¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

í•˜ì§€ë§Œ êµ¬ì¡° ë¶„í•´ í• ë‹¹ìœ¼ë¡œ ê°’ì„ ê°€ì ¸ì˜¤ë©´ ì–´ë–¤ ìƒíƒœê°€ ë³€ê²½ë˜ì–´ë„ ë¦¬ë Œë”ë§ë˜ëŠ”ë°, selectorë¥¼ ì‚¬ìš©í•˜ë©´ êµ¬ë…í•˜ëŠ” ìƒíƒœë§Œ ë³€ê²½ë  ë•Œ ë¦¬ë Œë”ë§ë©ë‹ˆë‹¤.

ì™œ ì´ë ‡ê²Œ ë™ì‘í•˜ëŠ”ì§€ ì•Œë ¤ë©´ zustand ë‚´ë¶€ë¥¼ ê¹Œë´ì•¼ í•©ë‹ˆë‹¤.

# Zustand ë‚´ë¶€ êµ¬ê²½í•˜ê¸°

ìš°ì„  zustandì—ì„œ í™•ì¸í•´ì•¼í•  í•µì‹¬ ì½”ë“œëŠ” `src/vanilla.ts`ì™€ `src/react.ts`ì…ë‹ˆë‹¤.

## vanilla.ts - createStore

```ts
// src/vanilla.ts
const createStoreImpl: CreateStoreImpl = (createState) => {
  type TState = ReturnType<typeof createState>;
  type Listener = (state: TState, prevState: TState) => void;
  let state: TState;
  const listeners: Set<Listener> = new Set();

  const setState: StoreApi<TState>["setState"] = (partial, replace) => {
    // ìƒˆë¡œìš´ ìƒíƒœ ê³„ì‚°
    const nextState =
      typeof partial === "function" ? (partial as (state: TState) => TState)(state) : partial;

    // Object.isë¡œ ìƒíƒœ ë¹„êµ
    if (!Object.is(nextState, state)) {
      const previousState = state;
      // ìƒíƒœ ì—…ë°ì´íŠ¸
      state =
        (replace ?? (typeof nextState !== "object" || nextState === null))
          ? (nextState as TState)
          : Object.assign({}, state, nextState);
      // êµ¬ë…ìë“¤ì—ê²Œ ìƒíƒœ ë³€ê²½ì„ ì „íŒŒ
      listeners.forEach((listener) => listener(state, previousState));
    }
  };

  const getState: StoreApi<TState>["getState"] = () => state;

  const getInitialState: StoreApi<TState>["getInitialState"] = () => initialState;

  const subscribe: StoreApi<TState>["subscribe"] = (listener) => {
    listeners.add(listener);
    // êµ¬ë… í•´ì œ
    return () => listeners.delete(listener);
  };

  const api = { setState, getState, getInitialState, subscribe };
  const initialState = (state = createState(setState, getState, api));
  return api as any;
};
```

### stateì™€ closure

zustandëŠ” ìƒíƒœë¥¼ í•¨ìˆ˜ ë‚´ë¶€ì˜ `let state`ë¡œ ì„ ì–¸í•©ë‹ˆë‹¤.
í•¨ìˆ˜ê°€ ì‹¤í–‰ë˜ê³  api ê°ì²´ê°€ ë°˜í™˜ëœ í›„ì—ë„, api ë‚´ë¶€ì˜ ë©”ì„œë“œë“¤ì€ í´ë¡œì € ë•ë¶„ì— ì´ `state`ì— ê³„ì† ì ‘ê·¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
ì™¸ë¶€ì—ì„œëŠ” state ë³€ìˆ˜ì— ì§ì ‘ ì ‘ê·¼í•  ìˆ˜ ì—†ê³ , ì˜¤ì§ apië¥¼ í†µí•´ì„œë§Œ ìƒíƒœë¥¼ ì¡°íšŒí•˜ê±°ë‚˜ ë³€ê²½í•  ìˆ˜ ìˆì–´ ì•ˆì „í•©ë‹ˆë‹¤.

### Listeners

ìƒíƒœê°€ ë³€ê²½ë  ë•Œ ì•Œë¦¼ì„ ë³´ë‚¼ êµ¬ë…ì ëª©ë¡ì„ ê´€ë¦¬í•˜ê¸° ìœ„í•´ ë°°ì—´ì´ ì•„ë‹Œ Setì„ ì‚¬ìš©í–ˆìŠµë‹ˆë‹¤.
Setì„ í†µí•´ ì•„ë˜ì™€ ê°™ì€ ì´ì ì„ ê°€ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

- ì¤‘ë³µ ë°©ì§€: ë™ì¼í•œ ë¦¬ìŠ¤ë„ˆê°€ ì—¬ëŸ¬ ë²ˆ ë“±ë¡ë˜ëŠ” ê²ƒì„ ìë™ìœ¼ë¡œ ë§‰ì•„ì¤ë‹ˆë‹¤.
- ì‚­ì œ íš¨ìœ¨ì„±: êµ¬ë… í•´ì œì‹œ ë°°ì—´ì€ filterë‚˜ spliceë¥¼ ì‚¬ìš©í•´ O(N)ì˜ ë¹„ìš©ì´ ë“¤ì§€ë§Œ, Setì˜ delete ë©”ì„œë“œëŠ” O(1)ì…ë‹ˆë‹¤.

### setStateì™€ ë¶ˆë³€ì„±

`Object.assign({}, state, nextState)`ë¥¼ ì‚¬ìš©í•´ ë¹ˆ ê°ì²´ì— ê¸°ì¡´ ìƒíƒœì™€ ìƒˆë¡œìš´ ìƒíƒœë¥¼ í•©ì¹©ë‹ˆë‹¤.
ì´ë ‡ê²Œ í•˜ë©´ ë‚´ìš©ë¬¼ì´ ê°™ë”ë¼ë„ ê°ì²´ì˜ ì°¸ì¡°ê°’(ë©”ëª¨ë¦¬ ì£¼ì†Œ)ì´ ì™„ì „íˆ ìƒˆë¡œìš´ ê°ì²´ê°€ íƒ„ìƒí•©ë‹ˆë‹¤.
ReactëŠ” ê°ì²´ì˜ ì°¸ì¡°ê°’ì´ ë°”ë€Œì–´ì•¼ ë³€ê²½ì„ ê°ì§€í•˜ê³  ë¦¬ë Œë”ë§ì„ í•˜ê¸° ë•Œë¬¸ì—, ì´ ë¶€ë¶„ì€ Reactì™€ì˜ ì—°ë™ì„ ìœ„í•´ í•„ìˆ˜ì ì¸ ë¡œì§ì…ë‹ˆë‹¤.

### Object.is

ë¬´ì¡°ê±´ ìƒíƒœë¥¼ ì—…ë°ì´íŠ¸í•˜ê³  êµ¬ë…ìì—ê²Œ ì•Œë¦¬ëŠ” ê²ƒì´ ì•„ë‹™ë‹ˆë‹¤. `Object.is`ë¥¼ ì‚¬ìš©í•˜ì—¬ "ì •ë§ ê°’ì´ ë³€í–ˆëŠ”ì§€" ë¨¼ì € í™•ì¸í•©ë‹ˆë‹¤.
nextStateì™€ í˜„ì¬ stateê°€ ê°™ë‹¤ë©´, ì•„ë¬´ëŸ° ë™ì‘ë„ í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤
ì´ë¥¼ í†µí•´ ë¶ˆí•„ìš”í•œ ì—°ì‚°ê³¼ ë¦¬ë Œë”ë§ ì „íŒŒë¥¼ ë°©ì§€í•˜ëŠ” ìµœì í™”ê°€ ë‚´ë¶€ì ìœ¼ë¡œ ë˜ì–´ ìˆìŒì„ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

## react.ts - useStore

```ts
// src/react.ts
export function useStore<TState, StateSlice>(
  api: ReadonlyStoreApi<TState>,
  selector: (state: TState) => StateSlice = identity as any,
) {
  const slice = React.useSyncExternalStore(
    api.subscribe,
    // Snapshot
    React.useCallback(() => selector(api.getState()), [api, selector]),
    // SSRìš© Snapshot
    React.useCallback(() => selector(api.getInitialState()), [api, selector]),
  );
  React.useDebugValue(slice);
  return slice;
}
```

### useSyncExternalStore

useSyncExternalStoreëŠ” ì™¸ë¶€ storeë¥¼ êµ¬ë…í•  ìˆ˜ ìˆëŠ” React Hookì…ë‹ˆë‹¤.

```ts
const snapshot = useSyncExternalStore(subscribe, getSnapshot, getServerSnapshot?)
```

storeì— ìˆëŠ” ë°ì´í„°ì˜ ìŠ¤ëƒ…ìƒ·ì„ ë°˜í™˜í•©ë‹ˆë‹¤. ë‘ ê°œì˜ í•¨ìˆ˜ë¥¼ ì¸ìˆ˜ë¡œ ì „ë‹¬í•´ì•¼ í•©ë‹ˆë‹¤.

subscribe í•¨ìˆ˜ëŠ” storeë¥¼ êµ¬ë…í•˜ê³  êµ¬ë…ì„ ì·¨ì†Œí•˜ëŠ” í•¨ìˆ˜ë¥¼ ë°˜í™˜í•´ì•¼ í•©ë‹ˆë‹¤.
getSnapshot í•¨ìˆ˜ëŠ” storeì—ì„œ ë°ì´í„°ì˜ ìŠ¤ëƒ…ìƒ·ì„ ì½ì–´ì•¼ í•©ë‹ˆë‹¤.

**ì´ë•Œ Snapshotì´ ì´ì „ê³¼ ë‹¤ë¥´ë‹¤ë©´ ë¦¬ìŠ¤ë„ˆ(êµ¬ë…ì)ì—ê²Œ ë¦¬ë Œë”ë§í•˜ë„ë¡ ì•Œë¦½ë‹ˆë‹¤.**

ìì„¸í•œ ë‚´ìš©ì€ [ê³µì‹ë¬¸ì„œ](https://ko.react.dev/reference/react/useSyncExternalStore)ë¥¼ í†µí•´ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### api.subscribe

`useSyncExternalStore`ì˜ ì²« ë²ˆì§¸ ì¸ìëŠ” êµ¬ë… í•¨ìˆ˜ì…ë‹ˆë‹¤.
`vanilla.ts`ì—ì„œ ë§Œë“¤ì—ˆë˜ `api.subscribe`ë¥¼ ê·¸ëŒ€ë¡œ ì „ë‹¬í•©ë‹ˆë‹¤. Store ë‚´ë¶€ì˜ ìƒíƒœê°€ ë³€ê²½ë˜ì–´ listenersê°€ í˜¸ì¶œë  ë•Œ, Reactì—ê²Œ "ìƒíƒœê°€ ë³€í–ˆìœ¼ë‹ˆ ë‹¤ì‹œ ê·¸ë ¤ì•¼ í•´"ë¼ê³  ì•Œë¦¬ëŠ” ì—­í• ì„ í•©ë‹ˆë‹¤.

### getSnapshotê³¼ Selector

ë‘ ë²ˆì§¸ëŠ” í˜„ì¬ ìŠ¤í† ì–´ì˜ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ëŠ” `getSnapshot`í•¨ìˆ˜ì…ë‹ˆë‹¤.

```ts
React.useCallback(() => selector(api.getState()), [api, selector]);
```

ReactëŠ” ë Œë”ë§ì´ í•„ìš”í•  ë•Œë§ˆë‹¤ ì´ í•¨ìˆ˜ë¥¼ ì‹¤í–‰í•´ì„œ í˜„ì¬ ê°’ì„ ê°€ì ¸ì˜¤ëŠ”getSnapshot í•¨ìˆ˜ì…ë‹ˆë‹¤.
ê·¸ë¦¬ê³  ì´ì „ ê°’ê³¼ í˜„ì¬ ê°’ì„ `Object.is`ë¡œ ë¹„êµí•˜ì—¬ ë¦¬ë Œë”ë§ ì—¬ë¶€ë¥¼ ê²°ì •í•©ë‹ˆë‹¤.
ì—¬ê¸°ì„œ ì¤‘ìš”í•œ ì ì€ `api.getState()(ì „ì²´ ìƒíƒœ)`ë¥¼ ë°”ë¡œ ë„˜ê¸°ëŠ” ê²ƒì´ ì•„ë‹ˆë¼, `selectorë¥¼ ê±°ì¹œ ë°˜í™˜ê°’`ì„ Reactì—ê²Œ ë„˜ê²¨ì¤€ë‹¤ëŠ” ì ì…ë‹ˆë‹¤.

### identity

```ts
const identity = <T>(arg: T): T => arg;
export function useStore<S extends ReadonlyStoreApi<unknown>>(api: S): ExtractState<S>;

export function useStore<S extends ReadonlyStoreApi<unknown>, U>(
  api: S,
  selector: (state: ExtractState<S>) => U,
): U;
```

ë§Œì•½ ì‚¬ìš©ìê°€ `useStore()`ì²˜ëŸ¼ selectorë¥¼ ì „ë‹¬í•˜ì§€ ì•ŠëŠ”ë‹¤ë©´ `identity`í•¨ìˆ˜ë¥¼ í†µí•´ ë°›ì€ ê°’ì„ ê·¸ëŒ€ë¡œ ë°˜í™˜í•©ë‹ˆë‹¤.

ì¦‰, selectorê°€ ì—†ìœ¼ë©´ `getSnapshot`ì˜ ê²°ê³¼ëŠ” **Storeì˜ ì „ì²´ state ê°ì²´**ê°€ ë©ë‹ˆë‹¤
ì•ì„œ vanilla.tsì—ì„œ ë´¤ë“¯ì´ state ê°ì²´ëŠ” ì—…ë°ì´íŠ¸ë  ë•Œë§ˆë‹¤ `Object.assign`ì— ì˜í•´ **ìƒˆë¡œìš´ ì°¸ì¡°ê°’(ìƒˆ ê°ì²´)**ì„ ê°€ì§‘ë‹ˆë‹¤.
**ë”°ë¼ì„œ ReactëŠ” ë‚´ìš©ì´ ë³€í–ˆë“  ì•ˆ ë³€í–ˆë“  "ì°¸ì¡°ê°’ì´ ë‹¤ë¥´ë‹ˆ ë³€ê²½ë˜ì—ˆë‹¤"ê³  íŒë‹¨í•´ ë¦¬ë Œë”ë§ì„ ì¼ìœ¼í‚µë‹ˆë‹¤.**

### useBoundStore

```ts
export type UseBoundStore<S extends ReadonlyStoreApi<unknown>> = {
  (): ExtractState<S>;
  <U>(selector: (state: ExtractState<S>) => U): U;
} & S;

const createImpl = <T>(createState: StateCreator<T, [], []>) => {
  const api = createStore(createState);

  const useBoundStore: any = (selector?: any) => useStore(api, selector);

  Object.assign(useBoundStore, api);

  return useBoundStore;
};

export const create = (<T>(createState: StateCreator<T, [], []> | undefined) =>
  createState ? createImpl(createState) : createImpl) as Create;
```

`useBoundStore`ëŠ” ì»´í¬ë„ŒíŠ¸ì—ì„œ ì‚¬ìš©í•˜ê²Œ ë  ì»¤ìŠ¤í…€ í›…ìœ¼ë¡œ, selectorë¥¼ ì„ íƒì ìœ¼ë¡œ ë°›ì„ ìˆ˜ ìˆìœ¼ë©°, `useStore`ë¥¼ í˜¸ì¶œí•˜ë©° ìƒíƒœ ê°’ì„ ë°˜í™˜í•©ë‹ˆë‹¤.

# ê·¸ëŸ¼ ì–´ë–»ê²Œ ë™ì‘í• ê¹Œ?

ì´ì œ storeë¥¼ ê°€ì ¸ì˜¬ ë•Œ ì•„ë˜ 2ê°€ì§€ ë°©ë²• ì¤‘ í•˜ë‚˜ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.

- `const { bears, increasePopulation, removeAllBears } = useBearStore();`
- `const bears = useBearStore(state=>state.bears);`

## êµ¬ì¡° ë¶„í•´ í• ë‹¹

```ts
const { bears, increasePopulation, removeAllBears } = useBearStore();
```

êµ¬ì¡° ë¶„í•´ í• ë‹¹ì˜ ê²½ìš° selectorë¥¼ ì „ë‹¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
ë”°ë¼ì„œ ê¸°ë³¸ì ìœ¼ë¡œ selectorì˜ ë§¤ê°œë³€ìˆ˜ëŠ” `state=>state` ê¸°ë³¸ í•¨ìˆ˜ê°€ ì „ë‹¬ë©ë‹ˆë‹¤.
ì´ë•Œ `slice`ëŠ” storeì˜ ì „ì²´ê°€ ì „ë‹¬ë©ë‹ˆë‹¤.

### êµ¬ì¡° ë¶„í•´ í• ë‹¹ì—ì„œì˜ ë¦¬ë Œë”ë§

```ts
const ComponentA = () => {
  const { increasePopulation } = useBearStore();
};
const ComponentB = () => {
  const { bears } = useBearStore();
};
```

2ê°œì˜ ì»´í¬ë„ŒíŠ¸ê°€ ìˆì„ ë•Œ êµ¬ì¡° ë¶„í•´ í• ë‹¹ì„ í•˜ê²Œ ë˜ë©´ bearsê°€ ë³€ê²½ëì„ ë•Œ ì´ìƒì ì´ë¼ë©´ `ComponentA`ëŠ” ë¦¬ë Œë”ë§ì´ ë˜ì§€ ì•Šì•„ì•¼ í•©ë‹ˆë‹¤.

í•˜ì§€ë§Œ Selectorë¥¼ ì „ë‹¬í•˜ì§€ ì•Šì•˜ê¸° ë•Œë¬¸ì— store ì „ì²´ê°€ ì „ë‹¬ë©ë‹ˆë‹¤.
ì´ë ‡ê²Œ ë˜ë©´ bearsê°€ ë³€ê²½ë˜ë©´ Object.assignì„ í†µí•´ ìƒˆë¡œìš´ ê°ì²´ê°€ ìƒì„±ì´ ë©ë‹ˆë‹¤.

ìƒˆë¡œìš´ ê°ì²´ëŠ” ì´ì „ ê°ì²´ì™€ ë‹¤ë¥¸ ë©”ëª¨ë¦¬ ì£¼ì†Œë¥¼ ê°€ì§€ê¸° ë•Œë¬¸ì— Object.isë¡œ ë¹„êµí•˜ë©´ í•­ìƒ ë‹¤ë¥´ë‹¤ê³  íŒë‹¨í•©ë‹ˆë‹¤.

ë”°ë¼ì„œ ë¦¬ë Œë”ë§ì´ ë°œìƒí•˜ê²Œ ë©ë‹ˆë‹¤.

## Selector

```ts
const bears = useBearStore((state) => state.bears);

const selector = (state) => state.bears;
```

Selectorë¥¼ ì „ë‹¬í•˜ê¸° ë•Œë¬¸ì— `state=>state.bears`ê°€ ì „ë‹¬ë©ë‹ˆë‹¤.
ì´ë•Œ `slice`ì—ëŠ” selectorê°€ ë°˜í™˜í•˜ëŠ” **bearsë§Œ** ì „ë‹¬ë©ë‹ˆë‹¤.

### Selectorì—ì„œì˜ ë¦¬ë Œë”ë§

```ts
const ComponentA = () => {
  const increasePopulation = useBearStore((state) => state.increasePopulation);
};

const ComponentB = () => {
  const bears = useBearStore((state) => state.bears);
};
```

ë§ˆì°¬ê°€ì§€ë¡œ 2ê°œì˜ ì»´í¬ë„ŒíŠ¸ê°€ ìˆê³ , bearsê°€ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤.
í•˜ì§€ë§Œ ì´ë²ˆì—ëŠ” Selectorì— `bears`ê°€ ì „ë‹¬ë˜ì—ˆìŠµë‹ˆë‹¤.

- ComponentAì˜ ê²½ìš° (ë¦¬ë Œë”ë§ X)
- Snapshot ë¹„êµ: increasePopulation í•¨ìˆ˜(ì´ì „) vs increasePopulation í•¨ìˆ˜(í˜„ì¬)
- Object.is ê²°ê³¼: true (í•¨ìˆ˜ëŠ” ë³€í•˜ì§€ ì•Šì•˜ìœ¼ë¯€ë¡œ)

A ê²°ê³¼: ìƒíƒœ ê°ì²´(state) ìì²´ëŠ” ë°”ë€Œì—ˆì§€ë§Œ, Selectorê°€ ë½‘ì•„ë‚¸ ê°’ì€ ê°™ìœ¼ë¯€ë¡œ ë¦¬ë Œë”ë§ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.

- ComponentBì˜ ê²½ìš° (ë¦¬ë Œë”ë§ O)
- Snapshot ë¹„êµ: 0 (ì´ì „) vs 1 (í˜„ì¬)
- Object.is ê²°ê³¼: false

B ê²°ê³¼: ê°’ì´ ì‹¤ì œë¡œ ë³€í–ˆìœ¼ë¯€ë¡œ ë¦¬ë Œë”ë§ì´ ë°œìƒí•©ë‹ˆë‹¤.

## useShallow

Selectorë¥¼ ì“°ë©´ ë¶ˆí•„ìš”í•œ ë¦¬ë Œë”ë§ì„ ë§‰ì„ ìˆ˜ ìˆë‹¤ëŠ” ê²ƒì„ ì•Œì•˜ìŠµë‹ˆë‹¤. ê·¸ëŸ°ë° ë§Œì•½ ì—¬ëŸ¬ ê°œì˜ ìƒíƒœë¥¼ í•œêº¼ë²ˆì— ê°€ì ¸ì˜¤ê³  ì‹¶ë‹¤ë©´ ì–´ë–»ê²Œ í•´ì•¼ í• ê¹Œìš”?

```ts
const { bears, fish } = useBearStore((state) => ({
  bears: state.bears,
  fish: state.fish,
}));
```

ì´ë ‡ê²Œ ë– ì˜¬ëìŠµë‹ˆë‹¤.
selectorë¥¼ í†µí•´ bearsì™€ fishë§Œ ê°€ì ¸ì˜¤ëŠ” ê²ƒ ê°™ìŠµë‹ˆë‹¤.
í•˜ì§€ë§Œ Selector í•¨ìˆ˜ `(state)=>({...})`ëŠ” ì‹¤í–‰ë  ë•Œë§ˆë‹¤ ìƒˆë¡œìš´ ê°ì²´ ë¦¬í„°ëŸ´ì„ ìƒì„±í•©ë‹ˆë‹¤.

- Snapshot: `{ bears: 0, fish: 0 }` (ìƒˆë¡œìš´ ì°¸ì¡°ê°’ A)
- ë³€ê²½ ë°œìƒ: ë‹¤ë¥¸ ìƒíƒœê°€ ë³€í•´ì„œ getSnapshotì´ ë‹¤ì‹œ ì‹¤í–‰ë¨.
- New Snapshot: `{ bears: 0, fish: 0 }` (ìƒˆë¡œìš´ ì°¸ì¡°ê°’ B)
- ë¹„êµ: ë‚´ìš©ë¬¼ì€ ê°™ì§€ë§Œ ì°¸ì¡°ê°’ì´ ë‹¤ë¥´ë¯€ë¡œ Object.is(A, B)ëŠ” falseì…ë‹ˆë‹¤.
- ê²°ê³¼: ê°’ì´ ë³€í•˜ì§€ ì•Šì•˜ëŠ”ë°ë„ ë¦¬ë Œë”ë§ì´ ë°œìƒí•©ë‹ˆë‹¤.

ì´ ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ zustandëŠ” `useShallow`ë¥¼ ì œê³µí•©ë‹ˆë‹¤.

```ts
import { useShallow } from "zustand/react/shallow";

const { bears, fish } = useBearStore(
  useShallow((state) => ({
    bears: state.bears,
    fish: state.fish,
  })),
);
```

`useShallow`ëŠ” Selectorê°€ ë°˜í™˜í•˜ëŠ” ê°ì²´ì˜ ì°¸ì¡°ê°’ì´ ì•„ë‹ˆë¼, ê°ì²´ ë‚´ë¶€ì˜ ê°’ë“¤ì„ ì–•ì€ ë¹„êµí•˜ë„ë¡ ë§Œë“­ë‹ˆë‹¤.

ì´ì œ ë™ì‘ ë°©ì‹ì´ ë°”ë€ë‹ˆë‹¤.

- Selectorê°€ ìƒˆë¡œìš´ ê°ì²´ë¥¼ ë°˜í™˜í•˜ë”ë¼ë„,
- useShallowê°€ ì´ì „ ê°ì²´ì˜ í”„ë¡œí¼í‹°(prev.bears)ì™€ í˜„ì¬ ê°ì²´ì˜ í”„ë¡œí¼í‹°(next.bears)ë¥¼ í•˜ë‚˜ì”© ë¹„êµí•©ë‹ˆë‹¤.
- ë‚´ë¶€ ê°’ì´ ëª¨ë‘ ê°™ë‹¤ë©´, Reactì—ê²Œ "ë°ì´í„°ê°€ ë³€í•˜ì§€ ì•Šì•˜ë‹¤"ê³  ì•Œë ¤ ë¦¬ë Œë”ë§ì„ ë§‰ìŠµë‹ˆë‹¤.

---

# ì •ë¦¬

## 1. êµ¬ì¡° ë¶„í•´ í• ë‹¹ ë°©ì‹

```ts
const { bears, increasePopulation } = useBearStore();
```

### êµ¬ì¡° ë¶„í•´ í• ë‹¹ì˜ ë™ì‘ ë°©ì‹

- Store ì „ì²´ë¥¼ í•˜ë‚˜ì˜ ê°ì²´ë¡œ êµ¬ë…
- Selectorê°€ ì—†ìœ¼ë©´ `identity` í•¨ìˆ˜(`state => state`)ê°€ ê¸°ë³¸ê°’ìœ¼ë¡œ ì‚¬ìš©ë¨

### êµ¬ì¡° ë¶„í•´ í• ë‹¹ì˜ ë¦¬ë Œë”ë§ ì¡°ê±´

- Store ë‚´ë¶€ì˜ **ì–´ë–¤ ìƒíƒœë¼ë„** ë³€ê²½ë˜ë©´ ë¦¬ë Œë”ë§ ë°œìƒ
- `Object.assign({}, state, nextState)`ë¡œ í•­ìƒ ìƒˆë¡œìš´ ê°ì²´ ìƒì„±
- ìƒˆ ê°ì²´ëŠ” ìƒˆë¡œìš´ ë©”ëª¨ë¦¬ ì£¼ì†Œë¥¼ ê°€ì§
- `Object.is(ì´ì „ ê°ì²´, ìƒˆ ê°ì²´)` -> `false` -> ë¦¬ë Œë”ë§

### ë¬¸ì œì 

- ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ìƒíƒœê°€ ë³€ê²½ë˜ì–´ë„ ì»´í¬ë„ŒíŠ¸ê°€ ë¦¬ë Œë”ë§ë¨

## 2. Selector ë°©ì‹

```ts
const bears = useBearStore((state) => state.bears);
```

### Selector ë°©ì‹ì˜ ë™ì‘ ë°©ì‹

- Selector í•¨ìˆ˜ê°€ ë°˜í™˜í•˜ëŠ” **íŠ¹ì • ê°’ë§Œ** êµ¬ë…
- `useSyncExternalStore`ê°€ Selectorì˜ ê²°ê³¼ê°’ì„ snapshotìœ¼ë¡œ ê´€ë¦¬

### Selector ë°©ì‹ì˜ ë¦¬ë Œë”ë§ ì¡°ê±´

- Selectorê°€ ë°˜í™˜í•œ **í•´ë‹¹ ê°’ì´ ì‹¤ì œë¡œ ë³€ê²½**ë  ë•Œë§Œ ë¦¬ë Œë”ë§
- `Object.is(ì´ì „ ê°’, í˜„ì¬ ê°’)`ìœ¼ë¡œ ë¹„êµ
- ê°’ì´ ê°™ìœ¼ë©´ -> `true` -> ë¦¬ë Œë”ë§ ì•ˆ í•¨
- ê°’ì´ ë‹¤ë¥´ë©´ ->`false` -> ë¦¬ë Œë”ë§

### ì¥ì 

- í•„ìš”í•œ ìƒíƒœë§Œ ì •í™•í•˜ê²Œ êµ¬ë…í•˜ì—¬ ë¶ˆí•„ìš”í•œ ë¦¬ë Œë”ë§ ë°©ì§€

## 3. useShallow (ì—¬ëŸ¬ ìƒíƒœ êµ¬ë… ì‹œ)

```ts
const { bears, fish } = useBearStore(
  useShallow((state) => ({ bears: state.bears, fish: state.fish })),
);
```

### í•„ìš”í•œ ì´ìœ 

- ì¼ë°˜ Selectorë¡œ ê°ì²´ë¥¼ ë°˜í™˜í•˜ë©´ **ë§¤ë²ˆ ìƒˆë¡œìš´ ê°ì²´ ë¦¬í„°ëŸ´** ìƒì„±
- ë‚´ìš©ì´ ê°™ì•„ë„ ì°¸ì¡°ê°€ ë‹¤ë¥´ë©´ `Object.is` ë¹„êµì—ì„œ `false` ë°˜í™˜

### useShallowì˜ ë™ì‘ ë°©ì‹

- ê°ì²´ì˜ ì°¸ì¡°ê°€ ì•„ë‹Œ **ë‚´ë¶€ í”„ë¡œí¼í‹° ê°’ì„ ì–•ì€ ë¹„êµ**
- `prev.bears === next.bears && prev.fish === next.fish` ë°©ì‹ìœ¼ë¡œ ë¹„êµ
- ëª¨ë“  ê°’ì´ ê°™ìœ¼ë©´ ë³€ê²½ ì—†ìŒìœ¼ë¡œ ê°„ì£¼

### íš¨ê³¼

- ì—¬ëŸ¬ ìƒíƒœë¥¼ ë™ì‹œì— êµ¬ë…í•˜ë©´ì„œë„ ìµœì í™”ëœ ë¦¬ë Œë”ë§ ì œì–´ ê°€ëŠ¥

# ë§ˆì¹˜ë©°

zustand ë‚´ë¶€ë¥¼ ë³´ë©´ì„œ êµ¬ì¡° ë¶„í•´ í• ë‹¹ê³¼ selectorë°©ì‹ì˜ ì°¨ì´ë¥¼ ì•Œì•„ë´¤ëŠ”ë°, ì•ìœ¼ë¡œ selectorë°©ì‹ì„ í†µí•´ ë¶ˆí•„ìš”í•œ ë¦¬ë Œë”ë§ì„ ì¤„ì—¬ì•¼ê² ìŠµë‹ˆë‹¤.
ê·¸ë¦¬ê³  storeë¥¼ ë§Œë“¤ ë•ŒëŠ” ë„ˆë¬´ ë§ì€ ìƒíƒœì™€ ë©”ì„œë“œë¥¼ ê°€ì§€ì§€ ì•Šë„ë¡ ì˜ ë¶„ë¦¬í•´ì•¼ê² ìŠµë‹ˆë‹¤.

ì½ì–´ì£¼ì…”ì„œ ê°ì‚¬í•©ë‹ˆë‹¤! ğŸ™‡â€â™‚ï¸
ê¶ê¸ˆí•œ ì ì´ë‚˜ í‹€ë¦° ë¶€ë¶„ì´ ìˆë‹¤ë©´ ì–¸ì œë“ ì§€ ëŒ“ê¸€ë¡œ ì•Œë ¤ì£¼ì„¸ìš”

## ì°¸ê³ ìë£Œ

[zustand github](https://github.com/pmndrs/zustand)<br/>
[zustand docs](https://zustand.docs.pmnd.rs/getting-started/introduction)
